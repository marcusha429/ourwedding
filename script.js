emailjs.init('uslz-38maofgET7_g');

const translations = {
  en: {
    groomName: "MARCUS HA",
    brideName: "THANH THUY",
    meetthebride: "Meet The Bride",
    thechurch: "The Church",
    therestaurant: "The Restaurant",
    yourwish: "Your Wish",
    mins: "Mins",
    days: "Days",
    hours: "Hours",
    sendusyourwish: "Send us your wish",
    message: "We cherish your heartfelt wishes. Please leave your blessing below.",
    send: "Send Wish",
    back: "Back",
    yourgift: "Your Gift",
    youreinvited: "You're Invited",
    tenthanhgroom: "Joseph Marcus Ha",
    tenthanhbride: "Clara Tran Thi Thanh Thuy",
    churchaddress: "Join us at Tan Chi Linh Church<br>" + 
    "6/25 Pham Van Hai, Ward 3, Tan Binh District",
    churchtime: "June 28th, 2025",
    churchhour: "4:00 PM (GMT+7)",
    quote: "We become what we love and who we love shapes what we become.<br>" +
    "‚Äî St. Clare of Assisi",
    additional : "  ",
    weddingdetails: "Wedding Details",
    restauranttime: "June 28th, 2025<br>" + 
    "6:00 PM (GMT+7)<br><br>" +
    "Asiana Plaza Convention Center<br>" +
    "Alexa Hall - 10th Floor",
    restaurantaddress: "284‚Äì286 Vuon Lai, Phu Tho Hoa, Tan Phu District",
    gettingthere: "Getting There",
    drinks: "Drinks",
    alldrinks: "‚Ä¢ Coke ‚Ä¢ Beer ‚Ä¢ Water",
    goodeats: "Good Eats",
    allfoods: "‚Ä¢ Roasted Chicken & Pumpkin Salad<br>"+ 
    " ‚Ä¢ Oven-Baked Pork Rolls with Kimchi<br>"+ 
    " ‚Ä¢ Fish Maw Soup with Black Moss<br>"+ 
    " ‚Ä¢ Seafood in Pumpkin Sauce<br>" + 
    " ‚Ä¢ Roasted Chicken with Miso Sauce & Chef's Special Sticky Rice<br>"+
    " ‚Ä¢ Teochew-Style Seafood Hot Pot with Steamed Noodles<br>"+
    " ‚Ä¢ Sweet Red Date Soup with Palm Seeds",
    ourstory: "Our Story",
    firstsentence: "Seven years woven tightly.",
    secondsentence: "I greets the sun in Vietnam as he whispers goodnight from the U.S.",
    thirdsentence: "Our love, tested by miles and strengthened by patience, waits joyfully for the day we'll finally share every sunrise side by side.",
    lastsentence: "And our new chapter begins...",
    invitation: "Reception Invitation",
    togetherwithourfamilies: "Together with our families,",
    inviteat: "invite you to celebrate at Home.",
    meettime: "June 28th, 2025<br />"+
    "1:00 PM (GMT+7)",
    lastword: "We look forward to sharing this joyful moment!"

  },
  vi: {
    groomName: "MARCUS H√Ä",
    brideName: "THANH THU·ª≤",
    meetthebride: "L·ªÖ R∆∞·ªõc D√¢u",
    thechurch: "L·ªÖ H√¥n Ph·ªëi",
    therestaurant: "Ti·ªác C∆∞·ªõi",
    yourwish: "G·ª≠i L·ªùi Ch√∫c",
    mins: "Ph√∫t",
    days: "Ng√†y",
    hours: "Gi·ªù",
    sendusyourwish: "L·ªùi Ch√∫c M·ª´ng",
    message: "H√£y ƒë·ªÉ l·∫°i l·ªùi ch√∫c m·ª´ng c·ªßa b·∫°n b√™n d∆∞·ªõi. Xin g·ª≠i l·ªùi c·∫£m ∆°n s√¢u s·∫Øc ƒë·∫øn b·∫°n. ",
    send: "G·ª≠i",
    back: "Quay L·∫°i",
    yourgift: "Qu√† M·ª´ng C∆∞·ªõi",
    youreinvited: "L·ªÖ Th√†nh H√¥n",
    tenthanhgroom: "Giuse Marcus H√†",
    tenthanhbride: "Clara Tr·∫ßn Th·ªã Thanh Th√πy",
    churchaddress: "H√¥n l·ªÖ ƒë∆∞·ª£c c·ª≠ h√†nh t·∫°i Nh√† Th·ªù T√¢n Ch√≠ Linh<br>" + 
    "6/25 Ph·∫°m VƒÉn Hai, Ph∆∞·ªùng 3, Qu·∫≠n T√¢n B√¨nh",
    churchtime: "28.06.2025",
    churchhour: "V√†o L√∫c 16:00",
    quote: " ''Ch√∫ng ta s·∫Ω tr·ªü th√†nh nh·ªØng g√¨ ch√∫ng ta y√™u th∆∞∆°ng v√† ng∆∞·ªùi ch√∫ng ta y√™u th∆∞∆°ng s·∫Ω ƒë·ªãnh h√¨nh n√™n con ng∆∞·ªùi ch√∫ng ta.''<br>" +
    "‚Äî Th√°nh Clara, ƒê·ªìng Trinh",
    additional: "Th√¢n m·ªùi b·∫°n ƒë·∫øn d·ª±",
    weddingdetails: "L·ªÖ Th√†nh H√¥n",
    restauranttime: "28.06.2025<br>" + 
    "V√†o L√∫c 18:00<br><br>" +
    "Asiana Plaza<br>" +
    "S·∫£nh Alexa - T·∫ßng 10",
    restaurantaddress: "284‚Äì286 V∆∞·ªùn L√†i, Ph√∫ Th·ªç H√≤a, T√¢n Ph√∫",
    gettingthere: "B·∫£n ƒê·ªì",
    drinks: "Th·ª©c U·ªëng",
    alldrinks: "‚Ä¢ N∆∞·ªõc Ng·ªçt ‚Ä¢ Bia ‚Ä¢ N∆∞·ªõc Su·ªëi",
    goodeats: "M√≥n ƒÇn",
    allfoods: "‚Ä¢ X√† L√°ch B√≠ ƒê·ªè - G√† N∆∞·ªõng<br>"+ 
    " ‚Ä¢ Heo Cu·ªôn Kim Chi ƒê√∫t L√≤<br>"+ 
    " ‚Ä¢ S√∫p B√≥ng C√° T√≥c Ti√™n<br>"+
    " ‚Ä¢ H·∫£i S·∫£n X·ªët B√≠ ƒê·ªè<br>" +
    " ‚Ä¢ G√† Quay X·ªët Miso - X√¥i ƒê·∫∑c Bi·ªát<br>" + 
    " ‚Ä¢ L·∫©u H·∫£i S·∫£n Tri·ªÅu Ch√¢u - M√¨ H·∫•p<br>" +
    " ‚Ä¢ Ch√® T√°o ƒê·ªè H·∫°t ƒê√°c",
    ourstory: "M·ªôt H√†nh Tr√¨nh D√†i",
    firstsentence: "B·∫£y nƒÉm b√™n nhau.",
    secondsentence: "T·ªõ ƒë√≥n b√¨nh minh ·ªü Vi·ªát Nam c≈©ng l√† l√∫c anh ·∫•y nh·∫Øn ch√∫c ng·ªß ngon t·ª´ M·ªπ.",
    thirdsentence: "T√¨nh y√™u c·ªßa t·ª•i m√¨nh, b·ªã th√°ch th·ª©c b·ªüi kho·∫£ng c√°ch v√† b·ªÅn b·ªâ c√πng v·ªõi s·ª± ki√™n nh·∫´n, v√† gi·ªù ƒë√¢y c√πng nhau ch·ªù ƒë·ª£i ng√†y t·ª•i m√¨nh s·∫Ω v·ªÅ  chung m·ªôt nh√†.",
    lastsentence: "V√† m·ªôt b∆∞·ªõc ngo·∫∑t m·ªõi c·ªßa cu·ªôc ƒë·ªùi ƒë√£ b·∫Øt ƒë·∫ßu...",
    invitation: "Tr√¢n Tr·ªçng K√≠nh M·ªùi",
    togetherwithourfamilies: "ƒê·∫øn d·ª± bu·ªïi ti·ªác c√πng v·ªõi gia ƒë√¨nh ch√∫ng t√¥i,",
    inviteat: "H√¥n l·ªÖ ƒë∆∞·ª£c c·ª≠ h√†nh t·∫°i T∆∞ Gia",
    meettime: "Ng√†y 28 th√°ng 6 nƒÉm 2025<br />"+
    "V√†o L√∫c 13:00",
    lastword: "S·ª± hi·ªán di·ªán c·ªßa b·∫°n l√† ni·ªÅm vinh h·∫°nh cho ch√∫ng t√¥i!"
  }
};

//MUSIC 
const musicList = [
    'music/summerisforfallinginlove.mp3',
    'music/thoseeyes.mp3',
    'music/mylovemineallmine.mp3',
    'music/ithinktheycallthislove.mp3',
    'music/blue.mp3',
  ];
  let currentAudio = null;
  let isPlaying = false;
  
  function initAudio() {
    playRandomMusic();
  }
  function playRandomMusic() {
    if (isPlaying) return;
  
    const idx = Math.floor(Math.random() * musicList.length);
    currentAudio = new Audio(musicList[idx]);
    currentAudio.volume = 0.5;
    currentAudio.addEventListener('ended', () => {
      const next = (musicList.indexOf(currentAudio.src.split('/').pop()) + 1) % musicList.length;
      currentAudio.src = musicList[next];
      currentAudio.play().catch(e => console.log("Playback failed:", e));
    });
    currentAudio.play()
      .then(() => {
        isPlaying = true;
        document.getElementById('musicToggle').textContent = 'üéµ';
      })
      .catch(err => {
        console.log("Audio failed:", err);
        isPlaying = false;
        document.getElementById('musicToggle').textContent = 'üîá';
        document.addEventListener('click', initAudio, { once: true });
      });
  }
  
  document.addEventListener('DOMContentLoaded', () => {
    // ‚Äî‚Äî two-step grid logic ‚Äî‚Äî
    const formMap = {
      'wish-btn':       'wish-form-container',
      'church-btn':     'church-form-container',
      'restaurant-btn': 'restaurant-form-container',
      'home-btn':       'home-form-container',
    };
    const gridItems = document.querySelectorAll('.grid-item');
    gridItems.forEach(item => {
      item.addEventListener('click', () => {
        if (!item.classList.contains('active')) {
          gridItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          return;  // stop here on first tap
        }
        // second tap ‚Üí open form
        const formId = formMap[item.id];
        if (formId) {
          document.getElementById(formId).style.display = 'flex';
          gridItems.forEach(i => i.classList.remove('active'));
        }
      });
    });
  
    // ‚Äî‚Äî single music-control creation ‚Äî‚Äî
    const musicControls = document.createElement('div');
    musicControls.className = 'music-controls';
    musicControls.style = 'position: fixed; bottom: 20px; right: 20px; z-index: 1000;';
    musicControls.innerHTML = `
      <button onclick="toggleMusic()" id="musicToggle"
              style="padding:10px; border-radius:50%; background:rgba(255,255,255,0.8);">
        üîá
      </button>`;
    document.body.appendChild(musicControls);
  
    initAudio();  // kick off music
  
    // ‚Äî‚Äî door logic ‚Äî‚Äî
    const landing = document.getElementById("landing");
    document.querySelectorAll(".door").forEach(door => {
      door.addEventListener("click", () => {
        if (!landing.classList.contains("open")) {
          landing.classList.add("open");
        }
      });
    });
  
    // ‚Äî‚Äî countdown ‚Äî‚Äî
    updateCountdown();
    setInterval(updateCountdown, 1000);
  });

function toggleMusic() {
    if (!currentAudio) {
        playRandomMusic();
        return;
    }

    if (currentAudio.paused) {
        currentAudio.play()
            .then(() => {
                isPlaying = true;
                document.getElementById('musicToggle').textContent = 'üéµ';
            })
            .catch(error => console.log("Playback failed:", error));
    } else {
        currentAudio.pause();
        isPlaying = false;
        document.getElementById('musicToggle').textContent = 'üîá';
    }
}


// Form close functions
function closeWishForm() {
    document.getElementById("wish-form-container").style.display = "none";
    document.querySelector('.grid-item.active')?.classList.remove('active');
}

function closeChurchForm() {
    document.getElementById("church-form-container").style.display = "none";
    document.querySelector('.grid-item.active')?.classList.remove('active');
}

function closeRestaurantForm() {
    document.getElementById("restaurant-form-container").style.display = "none";
    document.querySelector('.grid-item.active')?.classList.remove('active');
}

function closeHomeForm() {
    document.getElementById("home-form-container").style.display = "none";
    document.querySelector('.grid-item.active')?.classList.remove('active');
}

function sendWish() {
  const nameEl = document.getElementById("name");
  const wishEl = document.getElementById("wish");
  const name = nameEl.value.trim();
  const wish = wishEl.value.trim();

  if (!name || !wish) {
    alert("Please fill out both your name and your wish!");
    return;
  }

  const templateParams = {
    user_name: name,
    message: wish
  };

  // send via EmailJS
  emailjs.send('service_g7g3w0g', 'template_xyez4a7', templateParams)
    .then(response => {
      console.log('SUCCESS:', response.status, response.text);
      alert("Thank you! Your wish has been sent.");
      closeWishForm();
      nameEl.value = "";
      wishEl.value = "";
    })
    .catch(err => {
      console.error('FAILED to send wish:', err);
      alert("Oops‚Äîsomething went wrong. Please try again later.");
    });
}

function updateCountdown() {
    const target = new Date("June 25, 2025 13:00:00").getTime();
    const now = Date.now();
    const diff = target - now;

    if (diff <= 0) {
        document.querySelector(".countdown-timer").innerHTML = 
            "<div class='countdown-box'><div class='countdown-number'>It's time!</div></div>";
        return;
    }

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hrs = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const mins = Math.floor((diff / (1000 * 60)) % 60);

    document.getElementById("days").textContent = String(days).padStart(2, "0");
    document.getElementById("hours").textContent = String(hrs).padStart(2, "0");
    document.getElementById("minutes").textContent = String(mins).padStart(2, "0");
}

setInterval(updateCountdown, 1000);
updateCountdown();

// ---- language handling ----
const langOverlay = document.getElementById('lang-overlay')
langOverlay.style.display = 'flex';


// When user clicks on a language button‚Ä¶
langOverlay.querySelectorAll('button[data-lang]').forEach(btn => {
  btn.addEventListener('click', () => {
    const lang = btn.dataset.lang;
    localStorage.setItem('lang', lang);
    applyLanguage(lang);
    langOverlay.style.display = 'none';
  });
});

// Function to swap all text and placeholders
function applyLanguage(lang) {
  // text content
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.dataset.i18n;
    if (translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });
  // placeholders
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.dataset.i18nPlaceholder;
    if (translations[lang][key]) {
      el.placeholder = translations[lang][key];
    }
  });
  // 3) HTML content (for anything with tags, like your address)
  document.querySelectorAll('[data-i18n-html]').forEach(el => {
    const key = el.dataset.i18nHtml;
    if (translations[lang][key]) {
      el.innerHTML = translations[lang][key];
    }
  });
}
